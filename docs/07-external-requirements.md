# 外部要件

## 1. はじめに

**外部要件**とは、システムの外から課される条件である。顧客・利用者・第三者サービス・法・契約・市場などが源になる。本ドキュメントはそれらを一覧化し、設計・実装・契約で満たすべき項目として明示する。内部要件（技術方針・品質目標・アーキテクチャ）は 01・03・04・05・09 に記載する。

---

## 2. 顧客・契約

- 本プロダクトは既存案件対応とする。プロダクトの一般販売ではなく、クライアント期待に応える範囲で設計する。
- 受託販売を想定する。納品物・受け入れ条件・サポート範囲・契約形態（請負／準委任など）は契約で定める。MVP段階で必要な契約スコープ（成果物、ログの扱い、知的財産）を決める。
- 日本企業向けとする。言語は日本語とする。クライアントが海外展開を求める場合は別要件として扱う。

---

## 3. 利用者

- 利用者像は [01-requirements.md](01-requirements.md) 第4節のユーザー想定に従う。
- 利用環境は、一般的なブラウザ（Chrome, Safari, Edge 等）でのアクセスを前提とする。モバイルは閲覧程度を想定し、入力・編集はデスクトップを主とする。
- アクセシビリティは、法令で強制されるレベルがなければ可能な範囲で配慮する。MVPでは最低限、ラベルとエラー表示のテキスト化とする。

---

## 4. 第三者サービス（API・インフラ）

- **Groq**: 利用規約・利用ポリシーに従う。無料枠の日次／月次制限・レート制限を超えない設計とする。APIキーは環境変数で保持する。クライアントに渡す場合は渡し方・権限を契約で整理する。
- **Supabase**: 利用規約に従う。無料枠の制限（プロジェクト数・DBサイズ・リクエスト数）内で収める。データの保存リージョンはSupabaseの規定に従う。クライアントが国内のみを求める場合は有料プランやリージョン選択を検討する。
- **Railway**: 利用規約に従う。無料枠またはクライアント負担のクレジット内でデプロイする。ダウンタイム・SLAは契約で定めない限り保証しない。

---

## 5. クロール対象（企業Webサイト）

- **robots.txt**: 尊重する。Disallow されているパスは取得しない。
- **利用規約・著作権**: 対象サイトの利用規約に従う。取得したテキストは要約・仮説生成の入力にのみ使い、転載・再配布は行わない。出力は「仮説・下書き」であり事実認定ではないことを画面で明示する（[04-implementation-decisions.md](04-implementation-decisions.md) 第6節の表示で対応する）。
- **アクセス頻度・User-Agent**: 同一サイトへの連続リクエストは間隔を空け、User-Agent を明示する。過度な負荷をかけない。

---

## 6. 法・コンプライアンス

- **個人情報**: 企業URL・会社名・編集した仮説・提案文を保存する。個人を特定する情報を意図的に収集しない設計とする。クライアントが個人情報を入力する運用にした場合は、利用目的・保持期間・削除を契約・プライバシーポリシーで定める。
- **著作権・免責**: 生成物は「公表情報に基づく仮説」であり、事実保証や権利侵害の責任を負わない旨を画面・利用規約で明示する。
- **AI生成物の表示**: 現時点で法令上の表示義務が明確でなければ「仮説である」「下書きである」の表示で足りる。今後義務化されたら対応する。

---

## 7. セキュリティ

- **APIキー・認証情報**: ソースに含めず、環境変数またはシークレット管理で扱う。クライアント環境で動かす場合は渡し方・権限を決める。
- **通信**: 本番は HTTPS とする。Railway は HTTPS を提供する。
- **入力検証**: URL 入力は形式検証とスキーム制限（http／https）を行う。XSS・CSRF は Next.js の一般的な対策で対応する。

---

## 8. データ・ログ

- **保持期間**: 編集データ・ログの保持期間は契約または運用方針で定める。未定の場合は MVP では無期限またはサービス終了までとし、削除要請は個別対応とする。
- **データの所在**: Supabase のリージョンはサービス規定に従う。クライアントが「国内のみ」を求める場合は要検討とする。
- **エクスポート・削除**: ユーザーがエクスポートしたテキストはクライアント側で管理する。DBに保存したデータの削除機能は、契約で必要なら追加する。

---

## 9. 市場・予算

- 予算はできるだけ無料で実装する。Groq／Supabase／Railway の無料枠を前提とする。クライアント負担で有料枠を使う場合は契約で明示する。
- 成功指標（1社あたり時間短縮・満足度・再現性）はクライアントと合意した上で測定する。測定方法・報告頻度は契約またはSOWで定める。

---

## 10. その他

- **既存版との関係**: CompanyIntel-Letter-Builder は検索・IR・バッチ付きの別版である。本MVPは Node 統一・HP のみ・Groq・Railway の別実装とする。両者の役割・提供範囲をクライアントとすり合わせる。
- **サポート・障害**: 受託としてのサポート範囲・対応時間・障害時の連絡先は契約で定める。MVP では「合理的な範囲で対応」とし、詳細は後で決める。
